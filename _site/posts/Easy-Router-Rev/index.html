<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Easy Router Rev" /><meta property="og:locale" content="en" /><meta name="description" content="Reverse engineering custom protocols on a router." /><meta property="og:description" content="Reverse engineering custom protocols on a router." /><link rel="canonical" href="https://faultpoint.com/posts/Easy-Router-Rev/" /><meta property="og:url" content="https://faultpoint.com/posts/Easy-Router-Rev/" /><meta property="og:site_name" content="FaultPoint" /><meta property="og:image" content="https://faultpoint.com/assets/posts/2023-10-29/6.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-10-29T00:00:00-04:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://faultpoint.com/assets/posts/2023-10-29/6.png" /><meta property="twitter:title" content="Easy Router Rev" /><meta name="twitter:site" content="@elbee_ez" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-10-29T00:00:00-04:00","datePublished":"2023-10-29T00:00:00-04:00","description":"Reverse engineering custom protocols on a router.","headline":"Easy Router Rev","image":"https://faultpoint.com/assets/posts/2023-10-29/6.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://faultpoint.com/posts/Easy-Router-Rev/"},"url":"https://faultpoint.com/posts/Easy-Router-Rev/"}</script><title>Easy Router Rev | FaultPoint</title><link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/fp_logo_transparent.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">FaultPoint</a><p class="site-subtitle fst-italic mb-0">An assortment of vulnerability research, technical posts, and unfunny puns</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/elbee-cyber" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/elbee_ez" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dontopenthis','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Easy Router Rev</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Easy Router Rev</h1><p class="post-desc fw-light mb-4">Reverse engineering custom protocols on a router.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1698552000" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 29, 2023 </time> </span><div class="mt-3 mb-3"> <a href="/assets/posts/2023-10-29/6.png" class="popup img-link preview-img shimmer"><img src="/assets/posts/2023-10-29/6.png" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/elbee_ez">Dylan Knoff</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1913 words" > <em>10 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Easy Router Rev</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Easy Router Rev</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><p>Reverse engineering custom protocols on a netgear router and searching for vulnerabilities.</p><h1 id="table-of-content">Table of content</h1><ol><li><a href="#foreword">Foreword</a><li><a href="#board">Board Analysis / OSINT</a><li><a href="#extraction">Firmware Extraction with ReadyShare</a><li><a href="#analysis">Firmware Analysis</a><li><a href="#pot">The Pot Protocol</a><li><a href="#tbd">To be continued…</a></ol><blockquote class="prompt-danger"><p>This is an archived post/project that will likely never be finished.</p></blockquote><h3 id="foreword"><span class="me-2">Foreword</span><a href="#foreword" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This post is to document my discovery and learning process as I get into embedded vulnerability research. I wanted to do this because I figured it would be an interesting environment to apply and cementify my rev skills and hopefully find some low hanging fruit. The hardware portion of the lab for ripping firmware is also relatively cheap. I started my first project on a router I grabbed from Goodwill. When I was initially starting this project (shortly before finals) in the spring, I was finding a lot of cool stuff. In particular, while doing VR on this router I ran into a custom protocol with an unknown purpose in addition to a custom <strong>upnp</strong> implementation. After the initial rev on the custom protocol, which I’ll henceforth refer to as the <strong>pot protocol</strong>, I had to pause the project to start studying for my final exams. I forgot about this project until a month ago. I was excited to bust out the old router, connect to UART and see what’s good, but alas the boot process could not even make it to the second stage. The router was completely bricked, looped in the very early stages of the boot process where it continuously tried over and over to read from flash, never even making it to UBOOT. <a href="/assets/posts/2023-10-29/1.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/1.png" alt="" loading="lazy"></a></p><p>Luckily, I had already extracted the firmware (plus I later found it online) so I can emulate it, but some things might prove tricky (the POT protocol uses its own partition that won’t be included implicitly when using something like Firmadyne). Nevertheless in face of all this trouble, this series will have a part two (probably diving into the world of qemu and system emulation) and hopefully will end in a CVE number if I’m lucky. However annoying, these issues that are stopping me from doing the actual VR can help me learn valuable skills and will be undoubtedly useful in future research. Just hopefully these issues don’t give me too much trouble as I still have about a thousand other devices I want to go through after this one.</p><h3 id="board-analysis--osint"><span class="me-2">Board Analysis / OSINT</span><a href="#board-analysis--osint" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Initially when I got the device I was curious about my chances of finding something juicy so I did some threat intelligence. Turns out, this thing is still pumping out bugs both on this specific router and from similar vendor products, and a lot of them are related to memory corruption. <a href="/assets/posts/2023-10-29/2.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/2.png" alt="" loading="lazy"></a></p><p>This is great news for me because that means I get to look at a lot of (probably) trashy code, plus I have a lot of devices from the same vendor in my collection all of which are old and second hand.</p><p>After I was finished inspiring myself I began OSINT related to the device itself, the FCC report reveals internal photos of the device which show what looks to be a UART and what’s likely a JTAG interface. <a href="/assets/posts/2023-10-29/3.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/3.png" alt="" loading="lazy"></a></p><p>In addition to the default login credentials for the web interface (<code class="language-plaintext highlighter-rouge">admin:password</code>), this is pretty much all I gathered during the recon phase and was more than enough. Afterall, this can get boring and there’s no better sound than the crackle of a plastic shell being peeled off of what’s really important. Opening the device itself, we can see that these peripherals are beautifully labeled to confirm the previous suspisions and that the UART interface still even has headers attached. <a href="/assets/posts/2023-10-29/4.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/4.png" alt="" loading="lazy"></a></p><p>You can easily determine what pin is what on the UART interface using a multimeter. Note that when you turn the device on the boot process will produce a lot of logging. Knowing this, you can turn the device on and observe the pins you suspect to be transmit and recieve. Transmit would fluctate at a higher voltage than recieve, because of the verbosity. After doing this test, we can also confirm the pins on the UART header. <a href="/assets/posts/2023-10-29/5.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/5.png" alt="" loading="lazy"></a></p><p>I ended up using a <a href="link">bus pirate</a> (which can do everything) to connect to serial with the following:</p><ul><li>V -&gt; 3.3v<li>T -&gt; MISO<li>R -&gt; MOSI<li>GND -&gt; GND</ul><p><a href="/assets/posts/2023-10-29/6.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/6.png" alt="" loading="lazy"></a></p><p>After that it’s just a matter of configuring the bus pirate for UART. Be sure to interact with a UART connection via a <em>bridge with flow control</em> so you can send and recieve data. <a href="/assets/posts/2023-10-29/7.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/7.png" alt="" loading="lazy"></a></p><p>During the boot process I spotted several interesting block devices being listed in the output. Notably the pot partition, which is being used by the POT protocol, in extracting the firmware, it would also be beneficial to extract these block devices. Note that MTD is the framework that allows I/O access to memory segments such as flash memory. <a href="/assets/posts/2023-10-29/8.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/8.png" alt="" loading="lazy"></a></p><p>Also for the sake of due diligence, I labeled the chips on the PCB and kept links to datasheets in my notes for reference. I observed the following:</p><ol><li>Atheros AR9580-ARIA (Wireless network driver)<li>Atheros AR8327-BLIA (Network switch chip)<li>NANYA NT5TU32M16EG-AC (DRAM) (512mb)<li>NANYA NT5TU32M16EG-AC (DRAM) (512mb)<li>ATHEROS AR9344 (SoC) (on chip flash) (MIPS) (https://datasheetspdf.com/pdf-file/825113/Atheros/AR9344/1) <a href="/assets/posts/2023-10-29/9.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/9.png" alt="" loading="lazy"></a></ol><h3 id="firmware-extraction"><span class="me-2">Firmware Extraction</span><a href="#firmware-extraction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>At the time of my research, I somehow overlooked the obvious place for the firmware to be and could not find it online. So I ended up extracting the firmware via Netgear’s ReadyShare feature. I initially considered UBOOT for firmware extraction, but upon noticing a USB port on the board figured there was a much easier route. On the UART we are dropped into an OpenWRT shell with a read-only squashfs filesystem. Netgear utilizes the readyshare feature and allows one to insert a thumbdrive to be used as an FTP storage device, which will obviously be writable. After plugging in a USB and rebooting the device it becomes discoverable. I begin by listing the mtd partitions and copying whatever I think is interesting. <a href="/assets/posts/2023-10-29/10.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/10.png" alt="" loading="lazy"></a> Devices are copied with the command <code class="language-plaintext highlighter-rouge">dd if=/dev/mtdblockX of=/mnt/sda1/example.bin</code> The block partitions are a ro block device and are what should be copied, rather than the mtd partition which provides direct access. I ended up downloading the following partitions:</p><ul><li>config - Router configurations, probably networking configuration<li>pot - related to custom protocol <a href="/assets/posts/2023-10-29/11.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/11.png" alt="" loading="lazy"></a><li>rootfs - file system<li>firmware - file system, kernel, uboot, etc<li>reserved - unknown Afterwards I am able to copy everything onto my computer over the network using the ReadyShare service. <a href="/assets/posts/2023-10-29/12.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/12.png" alt="" loading="lazy"></a> <a href="/assets/posts/2023-10-29/13.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/13.png" alt="" loading="lazy"></a></ul><h3 id="firmware-analysis"><span class="me-2">Firmware Analysis</span><a href="#firmware-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>At this point I did some environment setup by setting up the device as a MITM between my actual access point so I could interact with it easily in my LAN. I also checked that the device was using the latest firmware, which was from 2015! Starting my search, I recalled something I found particularly interesting from the boot logs was the following messages:</p><p><a href="/assets/posts/2023-10-29/14.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/14.png" alt="" loading="lazy"></a></p><p>There appears to be something particularly interesting being run during the boot process in <code class="language-plaintext highlighter-rouge">/etc/init.d/pot</code>. It executes the following MIPS binaries in order:</p><ul><li>potd<li>potval</ul><p><a href="/assets/posts/2023-10-29/15.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/15.png" alt="" loading="lazy"></a></p><p><strong>potd</strong> appears to be the main service, while <strong>potval</strong> seems to attempt to expose the service. Initial examination reveals the POT binaries are the same and what they execute differentiates based on the first argument which is the binary’s name.</p><p><a href="/assets/posts/2023-10-29/16.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/16.png" alt="" loading="lazy"></a></p><p>Searching the filesystem for more files that have strings that mention some sort of POT feature turns up the following list:</p><ul><li>/www/hidden_POT.htm<li>/www/POT.htm<li>/etc/init.d/pot<li>/tmp/pot_value<li>/usr/lib/opkg/info/pot.list<li>/usr/sbin/potd<li>/usr/sbin/potval<li>/usr/sbin/ntpst<li>/usr/sbin/stamac</ul><p>Also interestingly, there appears to be hidden pages to view the status of POT on the webserver. Looking at the exposed services, in addition to the POT protocol which is listening on port 3333, a custom implementation of <code class="language-plaintext highlighter-rouge">upnp</code> also seems to be in use, which is a historically buggy protocol.</p><h3 id="the-pot-protocol"><span class="me-2">The Pot Protocol</span><a href="#the-pot-protocol" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>So there is a custom protocol that appears to be doing some sort of black magic. Depending on what we send it and how it processes what we send it, it could be providing us some exploitation opportunity or it could be doing jack. Either way I aim to find out and ease my mind on this component of the firmware before moving onto another. My first point of research will obviously be the pot binary. Going into this I was hopeful and ready, but in the end I could not find anyway to abuse the service as it does not provide a lot of interaction or deeper functionality besides tracking time. Note that this is also the only component of the firmware I started analyzing before my finals and the untimely passing of this device, so in the second part I will likely be covering emulation, which will likely not be easily cheesable with Firmadyne since there are multiple block devices I also want emulated. But the next thing to analyze and the most interesting would be the custom UPnP protocol. This probably also does a lot more stuff and has a larger codespace. For now though, let’s cross this POT protocol off of the checklist. <a href="/assets/posts/2023-10-29/17.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/17.png" alt="" loading="lazy"></a></p><p>I did most of the analysis statically in Binja, but also interacted with the live service to confirm certain suspicions. Looking at main, we can see that depending on the name of argv[0], $t9 is set to the address of the relevant function and then called. I rename each symbol appropiately. <a href="/assets/posts/2023-10-29/18.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/18.png" alt="" loading="lazy"></a></p><p>Starting with the <code class="language-plaintext highlighter-rouge">potd</code> functionality, this portion of the program seems to be in charge of a few things:</p><ol><li>It will initialize the pot mtd if it is being run for the first time.<li>It will seek the next free spot from the partition and write it to the pot.<li>It will increment pot every minute, writing to the pot and seeking to the next free spot in thhe mtd.<ol><li>The max pot value is 4320<li>In the case that the next available offset in the mtd exceeds 0x20000 it will wrap to 0x0.</ol></ol><p>Firstly we see that the pot mtd is being opened and accessed by further functionality. We initialize seek_offset to 0 and creating an <code class="language-plaintext highlighter-rouge">0x800</code> buffer for the mtd. It starts by calling <code class="language-plaintext highlighter-rouge">lseek</code> with the seek_offset (which will be 0 the first iteration) and the mtd. This will change the file descriptor location in the mtd by adding the <code class="language-plaintext highlighter-rouge">eek_offset</code> Following this, 0x800 bytes are read into the <code class="language-plaintext highlighter-rouge">md_buff</code>. There is then a check to see if the first word is equal some sort of sentinel value, if it isn’t it will increase the seek_offset by 0x800 to point to the next POT value. There is also a check to make sure that the <code class="language-plaintext highlighter-rouge">seek_offset</code> is not at the max value. <a href="/assets/posts/2023-10-29/19.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/19.png" alt="" loading="lazy"></a></p><p>The other part of the conditional (when the next seeked offset starts with the sentinel value) the <code class="language-plaintext highlighter-rouge">seek_offset</code> is reset to 0 and to additional values that we’ll get to later or set. Based on this we can assume that the sentinel value denotes the last available free block in the mtd device.</p><p><a href="/assets/posts/2023-10-29/20.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/20.png" alt="" loading="lazy"></a></p><p>After this, the <code class="language-plaintext highlighter-rouge">free_spot</code> is set and the loop is broken. This whole block of the code is to simply initialize the <code class="language-plaintext highlighter-rouge">free_spot</code> to be used to read/write the pot values.</p><p><a href="/assets/posts/2023-10-29/21.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/21.png" alt="" loading="lazy"></a></p><p>Before moving onto the start of the interesting stuff, I ran into something a little weird when viewing the plt entries, it seems that Binja gets the default base address wrong. Note how each call is incorrectly resolving the one above it. (I later found out this was a new issue with BinaryNinja and MIPS, it for some reason messes up the plt)</p><p><a href="/assets/posts/2023-10-29/22.png" class="popup img-link shimmer"><img src="/assets/posts/2023-10-29/22.png" alt="" loading="lazy"></a></p><blockquote class="prompt-danger"><p>This is an archived post/project that will likely never be finished.</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/random-research/">Random Research</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/firmware-rev/" class="post-tag no-text-decoration" >firmware rev</a> <a href="/tags/embedded/" class="post-tag no-text-decoration" >embedded</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Easy%20Router%20Rev%20-%20FaultPoint&url=https%3A%2F%2Ffaultpoint.com%2Fposts%2FEasy-Router-Rev%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Easy%20Router%20Rev%20-%20FaultPoint&u=https%3A%2F%2Ffaultpoint.com%2Fposts%2FEasy-Router-Rev%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ffaultpoint.com%2Fposts%2FEasy-Router-Rev%2F&text=Easy%20Router%20Rev%20-%20FaultPoint" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/ringbus/">Ringbus: Deferred Free Across Caches (Writeup)</a><li class="text-truncate lh-lg"> <a href="/posts/Cracking-the-Defcon-30-Badge-Firmware/">Cracking the DEFCON 30 Badge Firmware</a><li class="text-truncate lh-lg"> <a href="/posts/binja-plugin-ropview/">Tool Release: RopView</a><li class="text-truncate lh-lg"> <a href="/posts/8-cves-on-the-wnr854t-junkyard/">'You Left this on the Internet?' Finding 8 Zero Days in the WNR854T for DistrictCon Junkyard</a><li class="text-truncate lh-lg"> <a href="/posts/Easy-Router-Rev/">Easy Router Rev</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a> <a class="post-tag btn btn-outline-primary" href="/tags/firmware-rev/">firmware rev</a> <a class="post-tag btn btn-outline-primary" href="/tags/embedded/">embedded</a> <a class="post-tag btn btn-outline-primary" href="/tags/angr/">angr</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/badge/">badge</a> <a class="post-tag btn btn-outline-primary" href="/tags/chip-extraction/">chip extraction</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/emulation/">emulation</a> <a class="post-tag btn btn-outline-primary" href="/tags/file-sim/">file-sim</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/8-cves-on-the-wnr854t-junkyard/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1742875200" data-df="ll" > Mar 25, 2025 </time><h4 class="pt-0 my-2">'You Left this on the Internet?' Finding 8 Zero Days in the WNR854T for DistrictCon Junkyard</h4><div class="text-muted"><p>How my university club dumpster dived eight CVEs for a year-0 conference including WAN RCE and NVRAM persistence.</p></div></div></a></article><article class="col"> <a href="/posts/Cracking-the-Defcon-30-Badge-Firmware/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1669093200" data-df="ll" > Nov 22, 2022 </time><h4 class="pt-0 my-2">Cracking the DEFCON 30 Badge Firmware</h4><div class="text-muted"><p>Flash extraction and reversing of the DC30 badge firmware.</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/running-a-ctf-wo-lifesupport/" class="btn btn-outline-primary" aria-label="Older" ><p>Running a CTF that Outlasts a Bag of Popcorn</p></a> <a href="/posts/binja-plugin-ropview/" class="btn btn-outline-primary" aria-label="Newer" ><p>Tool Release: RopView</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/elbee_ez">Dylan Knoff</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.4.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a> <a class="post-tag btn btn-outline-primary" href="/tags/firmware-rev/">firmware rev</a> <a class="post-tag btn btn-outline-primary" href="/tags/embedded/">embedded</a> <a class="post-tag btn btn-outline-primary" href="/tags/angr/">angr</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/badge/">badge</a> <a class="post-tag btn btn-outline-primary" href="/tags/chip-extraction/">chip extraction</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/emulation/">emulation</a> <a class="post-tag btn btn-outline-primary" href="/tags/file-sim/">file-sim</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
