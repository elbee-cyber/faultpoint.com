<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Cracking the DEFCON 30 Badge Firmware" /><meta property="og:locale" content="en" /><meta name="description" content="Flash extraction and reversing of the DC30 badge firmware." /><meta property="og:description" content="Flash extraction and reversing of the DC30 badge firmware." /><link rel="canonical" href="https://faultpoint.com/posts/Cracking-the-Defcon-30-Badge-Firmware/" /><meta property="og:url" content="https://faultpoint.com/posts/Cracking-the-Defcon-30-Badge-Firmware/" /><meta property="og:site_name" content="FaultPoint" /><meta property="og:image" content="https://faultpoint.com/assets/posts/2022-11-22/Screenshot_2.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-11-22T00:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://faultpoint.com/assets/posts/2022-11-22/Screenshot_2.png" /><meta property="twitter:title" content="Cracking the DEFCON 30 Badge Firmware" /><meta name="twitter:site" content="@elbee_ez" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-31T14:08:09-04:00","datePublished":"2022-11-22T00:00:00-05:00","description":"Flash extraction and reversing of the DC30 badge firmware.","headline":"Cracking the DEFCON 30 Badge Firmware","image":"https://faultpoint.com/assets/posts/2022-11-22/Screenshot_2.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://faultpoint.com/posts/Cracking-the-Defcon-30-Badge-Firmware/"},"url":"https://faultpoint.com/posts/Cracking-the-Defcon-30-Badge-Firmware/"}</script><title>Cracking the DEFCON 30 Badge Firmware | FaultPoint</title><link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/fp_logo_transparent.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">FaultPoint</a><p class="site-subtitle fst-italic mb-0">An assortment of vulnerability research, technical posts, and unfunny puns</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/elbee-cyber" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/elbee_ez" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dontopenthis','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Cracking the DEFCON 30 Badge Firmware</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Cracking the DEFCON 30 Badge Firmware</h1><p class="post-desc fw-light mb-4">Flash extraction and reversing of the DC30 badge firmware.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1669093200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Nov 22, 2022 </time> </span> <span> Updated <time data-ts="1761934089" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 31, 2025 </time> </span><div class="mt-3 mb-3"> <a href="/assets/posts/2022-11-22/Screenshot_2.png" class="popup img-link preview-img shimmer"><img src="/assets/posts/2022-11-22/Screenshot_2.png" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/elbee_ez">Dylan Knoff</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1327 words" > <em>7 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Cracking the DEFCON 30 Badge Firmware</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Cracking the DEFCON 30 Badge Firmware</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><p><a href="/assets/posts/2022-11-22/Screenshot_7.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_7.png" loading="lazy"></a> Extracting and reversing the firmware of the DC30 badge to beat the badge challenge!</p><h1 id="table-of-contents">Table of contents</h1><ol><li><a href="#backstory">Backstory</a><li><a href="#extraction">Firmware Extraction</a><li><a href="#analysis">Analysis and Finding Check</a><li><a href="#mapping">Mapping and Decoding</a></ol><p><a name="backstory"></a></p><h3 id="backstory-and-objective"><span class="me-2">Backstory and Objective</span><a href="#backstory-and-objective" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Once upon a time I was very excited to fly to Las Vegas and attend <a href="https://defcon.org/html/defcon-30/dc-30-index.html">DEFCON 30</a> the annual go-to security conference. This was going to be my first conference and I had purchased pre-registration tickets, which was a new system that DEFCON was using to allow attendees to guarantee a badge and semi-skip LINECON. However, because of a personal emergency that appeared last minute, I was unable to attend and I gifted my pre-registration to my good friend and mentor <a href="https://ctftime.org/user/3509">playoff-rondo</a>. Later on when I was catching up with him he gave me his badge. DEFCON badges usually have some sort of challenge on them and this year’s badge was some sort of piano keyboard. <a href="https://github.com/Kybr-git/DC30-Badge-Challenge-Writeup/blob/main/README.md">This is the writeup made by the attendee that solved the badge challenge and won a black badge</a>, as you can see it is meant to be solved in part by interacting with other attendees who have a different variant of the badge. This is obviously not possible for me, so my goal was to reverse engineer the badge and find what key combo needs to be pressed in order to win the first part of the challenge.</p><p><a name="extraction"></a></p><h3 id="part-1-extracting-firmware-from-spi-flash"><span class="me-2">Part 1: Extracting Firmware from SPI Flash</span><a href="#part-1-extracting-firmware-from-spi-flash" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I began by using a magnifying glass, pen and paper to identify all the visible chips on the PCB.</p><p><a href="/assets/posts/2022-11-22/Screenshot_1.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_1.png" loading="lazy"></a></p><p>The two important chips to note are the <a href="https://www.winbond.com/hq/product/code-storage-flash-memory/serial-nor-flash/?__locale=en&amp;partNo=W25Q16JV">Winbond W25Q16JV</a> (flash chip) and the <a href="https://thepihut.com/products/raspberry-pi-rp2040-microcontroller">RP2 B2</a> (microcontroller). The flash memory chip will be used to grab the firmware and will be the target chip to physically extract. The microcontroller will be used to determine the architecture, conventions and other information that will be useful when analyzing the firmware.</p><p>There are tools available to extract firmware from a surface-mounted chip without having to actually remove the component, however I will be using a <a href="https://www.aliexpress.us/item/2251832631316605.html?spm=a2g0o.ppclist.product.2.42fduQgFuQgFn0&amp;pdp_npi=2%40dis%21USD%21US%20%248.25%21%248.00%21%21%21%21%21%402101c84a16691420847026788ea9a4%2112000018677635870%21btf&amp;_t=pvid%3A91be51b8-068b-46f5-ad65-2474e20aa1d4&amp;afTraceInfo=32817631357__pc__pcBridgePPC__xxxxxx__1669142084&amp;gatewayAdapt=glo2usa&amp;_randl_shipto=US">TL866II+ universal programmer</a>, so I will have to remove the chip from the PCB, feed the chip to the device using the appropriate adapter and connect the programmer to my VM for extraction. A heat gun would be ideal for removing a small surface mounted chip like this without damaging the PCB, however I do not have access to such equipment, so I use a soldering iron and tweezers. I heat up each joint of the chip with the iron and lift the leg up with tweezers and a magnifying glass. After I have detached the chip from the board, I go around with the iron again and a desoldering pump in an attempt to clean up as much excess solder as possible from each leg. Then I lock the flash chip in the corresponding adapter and insert it into the TL866II+.</p><p><a href="/assets/posts/2022-11-22/Screenshot_2.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_2.png" loading="lazy"></a></p><p>Unfortunately, the whole ordeal was pretty messy and resulted in a bit of copper from the PCB being destroyed (as is natural for my first chip-off extraction).</p><p><a href="/assets/posts/2022-11-22/Screenshot_3.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_3.png" loading="lazy"></a></p><p>In my ubuntu machine I use <a href="https://gitlab.com/DavidGriffith/minipro/">the minipro program</a> to interact with the chip programmer. The following command writes the firmware to a file.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>minipro <span class="nt">-p</span> <span class="s2">"W25Q16JV@SOIC8"</span> <span class="nt">-r</span> flash.bin 
</pre></table></code></div></div><p>I can verify that this is the firmware by running <code class="language-plaintext highlighter-rouge">strings</code> and examining the output.</p><p><a href="/assets/posts/2022-11-22/Screenshot_4.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_4.png" loading="lazy"></a></p><p><a name="analysis"></a></p><h3 id="part-2-analyzing-firmware-and-finding-the-comparison-function"><span class="me-2">Part 2: Analyzing Firmware and Finding the Comparison Function</span><a href="#part-2-analyzing-firmware-and-finding-the-comparison-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The MCU is a rpi2040 which makes use of the <a href="https://en.wikipedia.org/wiki/Execute_in_place">“execute in place”</a> feature. This is a feature that improves performance by enabling execution directly in flash storage rather than execution in the MCU’s limited memory area. It is important that we keep this in mind before starting to analyze the firmware. Firmware has no entry point and instead has a defined address at which program execution begins. We can find this base address by viewing the <a href="https://datasheets.raspberrypi.com/rp2040/rp2040-datasheet.pdf">rpi2040 datasheet</a> and navigating to the “Address Map” page from the table of contents. The base address will be the XIP address (execute in place). We need to specify this address as the base address in whatever we use to analyze the firmware to load the correct segment.</p><p><a href="/assets/posts/2022-11-22/Screenshot_5.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_5.png" loading="lazy"></a></p><p>Using Binaryninja I can specify the base address when creating a new project. Binja automatically detects the thumb2 ARM architecture.</p><p><a href="/assets/posts/2022-11-22/Screenshot_6.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_6.png" loading="lazy"></a></p><p>I start to try and identify useful symbols and organize the code by searching through strings and going to their code references.</p><p><a href="/assets/posts/2022-11-22/Screenshot_7.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_7.png" loading="lazy"></a></p><p>Some areas have been incorrectly loaded as symbols so I undefine them.</p><p><a href="/assets/posts/2022-11-22/Screenshot_8.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_8.png" loading="lazy"></a></p><p><a href="/assets/posts/2022-11-22/Screenshot_9.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_9.png" loading="lazy"></a></p><p>I also rename symbols that have obvious functions for clarity.</p><p><a href="/assets/posts/2022-11-22/Screenshot_10.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_10.png" loading="lazy"></a></p><p>Identifying and following the code reference of the interesting string, “YOU DID IT!” leads to what seems to be the function that is called when a correct key combination is entered.</p><p><a href="/assets/posts/2022-11-22/Screenshot_11.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_11.png" loading="lazy"></a></p><p>The only code reference leads to the following function. The first thing I noted when initially examining it was the comparison inside the loop to 0x2d. This conditional is equal to <code class="language-plaintext highlighter-rouge">if(r3_1 == 0x2d(which is 46))</code> since the if-statement ends in a break. Examining the note count on my own badge and noting the number of badges with different variations, we know the total number of piano keys that make-up the passing combo is 46, since all badge’s music sheets will be used.</p><p><a href="/assets/posts/2022-11-22/Screenshot_12.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_12.png" loading="lazy"></a></p><p>The decompilation process complicated this loop a bit, so for sanity’s sake lets simplify it a bit in our heads. The while loop iterates over the length of the correct combo, once it reaches 46 (the length of the combo) it succeeds. The second if-statement is most important, it compares every key (it gets the key by referencing the location of the key presses in memory with the offset of the current index) with the given character at <strong>string[index]</strong> if it is not equal, it breaks ending the while loop early and never reaching the success block, else it increments combo_length. So the string in the second conditional is what we need to pay attention too.</p><p><code class="language-plaintext highlighter-rouge">C@&gt;&lt;&gt;@C@&gt;&lt;&gt;@C@CE@EC@&gt;&lt;C@&gt;&lt;&gt;@C@&gt;&lt;&gt;@&gt;@C@CE@EGDB@</code></p><p>Since each key press is being compared with this string, it is safe to assume that each character in this string is mapped to a physical key on the badge. We should find another function which identifies this mapping. This would likely be the keypress code blobs directly.</p><p>Some things to note before continuing:</p><ul><li>User key buffer stored @ 0x2000xxxx (keypresses).<li>The checkwin function will likely be called every time a key is pressed, to check if the newly modified buffer is a win.</ul><p><a name="mapping"></a></p><h3 id="part-3-finding-the-mapping-and-decoding-the-key-combo"><span class="me-2">Part 3: Finding the Mapping and Decoding the Key Combo</span><a href="#part-3-finding-the-mapping-and-decoding-the-key-combo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>checkwin has a lot of code references. Each call is likely in a blob for a key press. I’ll pin the references window and tag them all to keep everything organized and visible on the pane.</p><p><a href="/assets/posts/2022-11-22/Screenshot_13.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_13.png" loading="lazy"></a></p><p><a href="/assets/posts/2022-11-22/Screenshot_14.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_14.png" loading="lazy"></a></p><p>Examining the very first reference we can take note that a pointer is being passed as the argument. The value at this pointer is being assigned above. For this instance that value is 0x3c, whose ascii representation is “&lt;”.</p><p><a href="/assets/posts/2022-11-22/Screenshot_15.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_15.png" loading="lazy"></a></p><p>Each blob that assigns a mapping is sequential in the code block, so I can safely assume that these are the keyboard mappings assigned in the order as they appear on the physical keyboard.</p><p><a href="/assets/posts/2022-11-22/Screenshot_16.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_16.png" loading="lazy"></a></p><p>Proceeding to the next checkwin call will reveal the mapping for the C# key (the little black key) which comes next.</p><p><a href="/assets/posts/2022-11-22/Screenshot_17.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_17.png" loading="lazy"></a></p><p><a href="/assets/posts/2022-11-22/Screenshot_18.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_18.png" loading="lazy"></a></p><p>Proceeding through every checkwin call will reveal the character mappings for the entire keyboard.</p><p><a href="/assets/posts/2022-11-22/Screenshot_19.png" class="popup img-link shimmer"><img src="/assets/posts/2022-11-22/Screenshot_19.png" loading="lazy"></a></p><h1 id="hurray">Hurray!</h1><p>With these mappings we can decipher the string compared in the checkwin function to the equivalent keys on the keyboard.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">key_map</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">&lt;</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">C</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">=</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">C#</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">&gt;</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">D</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">?</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">D#</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">@</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">E</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">F</span><span class="sh">"</span><span class="p">,</span> 
<span class="sh">"</span><span class="s">B</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">F#</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">C</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">G</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">D</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">G#</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">E</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">F</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">A#</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">G</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">B</span><span class="sh">"</span><span class="p">}</span> 
<span class="n">key_combo</span> <span class="o">=</span> <span class="sh">""</span> 
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="sh">"</span><span class="s">C@&gt;&lt;&gt;@C@&gt;&lt;&gt;@C@CE@EC@&gt;&lt;C@&gt;&lt;&gt;@C@&gt;&lt;&gt;@&gt;@C@CE@EGDB@</span><span class="sh">"</span><span class="p">:</span> 
  <span class="n">key_combo</span> <span class="o">+=</span> <span class="n">key_map</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span> 
 
<span class="nf">print</span><span class="p">(</span><span class="n">key_combo</span><span class="p">)</span> 
</pre></table></code></div></div><p>The following is the correct key-combination/tune we need to play on the badge keyboard in order to pass the first challenge. <code class="language-plaintext highlighter-rouge">G E D C D E G E D C D E G E G A E A G E D C G E D C D E G E D C D E D E G E G A E A B G# F# E</code></p><h1 id="sources">Sources</h1><ul><li><a href="https://www.winbond.com/hq/support/documentation/levelOne.jsp?__locale=en&amp;DocNo=DA00-W25Q16JV.1">https://www.winbond.com/hq/support/documentation/levelOne.jsp?__locale=en&amp;DocNo=DA00-W25Q16JV.1</a><li><a href="https://datasheets.raspberrypi.com/rp2040/rp2040-datasheet.pdf">https://datasheets.raspberrypi.com/rp2040/rp2040-datasheet.pdf</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/ctf/">CTF</a>, <a href="/categories/embedded/">Embedded</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/firmware-rev/" class="post-tag no-text-decoration" >firmware rev</a> <a href="/tags/chip-extraction/" class="post-tag no-text-decoration" >chip extraction</a> <a href="/tags/badge/" class="post-tag no-text-decoration" >badge</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cracking%20the%20DEFCON%2030%20Badge%20Firmware%20-%20FaultPoint&url=https%3A%2F%2Ffaultpoint.com%2Fposts%2FCracking-the-Defcon-30-Badge-Firmware%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cracking%20the%20DEFCON%2030%20Badge%20Firmware%20-%20FaultPoint&u=https%3A%2F%2Ffaultpoint.com%2Fposts%2FCracking-the-Defcon-30-Badge-Firmware%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ffaultpoint.com%2Fposts%2FCracking-the-Defcon-30-Badge-Firmware%2F&text=Cracking%20the%20DEFCON%2030%20Badge%20Firmware%20-%20FaultPoint" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/Cracking-the-Defcon-30-Badge-Firmware/">Cracking the DEFCON 30 Badge Firmware</a><li class="text-truncate lh-lg"> <a href="/posts/8-cves-on-the-wnr854t-junkyard/">'You Left this on the Internet?' Finding 8 Zero Days in the WNR854T for DistrictCon Junkyard</a><li class="text-truncate lh-lg"> <a href="/posts/binja-plugin-ropview/">Tool Release: RopView</a><li class="text-truncate lh-lg"> <a href="/posts/running-a-ctf-wo-lifesupport/">Running a CTF that Outlasts a Bag of Popcorn</a><li class="text-truncate lh-lg"> <a href="/posts/ransomware-and-geopolitics-for-dummies/">International Implications of Ransomware for Dummies</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a> <a class="post-tag btn btn-outline-primary" href="/tags/firmware-rev/">firmware rev</a> <a class="post-tag btn btn-outline-primary" href="/tags/angr/">angr</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/badge/">badge</a> <a class="post-tag btn btn-outline-primary" href="/tags/chip-extraction/">chip extraction</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/embedded/">embedded</a> <a class="post-tag btn btn-outline-primary" href="/tags/emulation/">emulation</a> <a class="post-tag btn btn-outline-primary" href="/tags/file-sim/">file-sim</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/8-cves-on-the-wnr854t-junkyard/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1742875200" data-df="ll" > Mar 25, 2025 </time><h4 class="pt-0 my-2">'You Left this on the Internet?' Finding 8 Zero Days in the WNR854T for DistrictCon Junkyard</h4><div class="text-muted"><p>How my university club dumpster dived eight CVEs for a year-0 conference including WAN RCE and NVRAM persistence.</p></div></div></a></article><article class="col"> <a href="/posts/running-a-ctf-wo-lifesupport/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1694404800" data-df="ll" > Sep 11, 2023 </time><h4 class="pt-0 my-2">Running a CTF that Outlasts a Bag of Popcorn</h4><div class="text-muted"><p>Tales and experiences from running PatriotCTF 2023.</p></div></div></a></article><article class="col"> <a href="/posts/battelle-magical-goat/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1679544000" data-df="ll" > Mar 23, 2023 </time><h4 class="pt-0 my-2">Feed the Magical Goat (Battelle)</h4><div class="text-muted"><p>Reversing challenge from Battelle showcasing angr's file simulation feature.</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"><div class="btn btn-outline-primary disabled" aria-label="Older"><p>-</p></div><a href="/posts/battelle-magical-goat/" class="btn btn-outline-primary" aria-label="Newer" ><p>Feed the Magical Goat (Battelle)</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/elbee_ez">Dylan Knoff</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.4.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a> <a class="post-tag btn btn-outline-primary" href="/tags/firmware-rev/">firmware rev</a> <a class="post-tag btn btn-outline-primary" href="/tags/angr/">angr</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/badge/">badge</a> <a class="post-tag btn btn-outline-primary" href="/tags/chip-extraction/">chip extraction</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/embedded/">embedded</a> <a class="post-tag btn btn-outline-primary" href="/tags/emulation/">emulation</a> <a class="post-tag btn btn-outline-primary" href="/tags/file-sim/">file-sim</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
